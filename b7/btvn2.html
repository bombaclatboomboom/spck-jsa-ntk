<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <style>
        .container { 
            max-width:700px; 
            margin:24px auto; 
            font-family: Arial, sans-serif; 
        }
        h1 { 
            text-align:center; }
        .flex { 
            display:flex; 
            gap:16px; 
            align-items:flex-start; 
        }
        .card, form { 
            background:#f9f9f9; 
            padding:16px; 
            border-radius:8px; 
            box-shadow:0 1px 3px rgba(0,0,0,.08); 
        }
        .card { 
            flex:1; 
            display:block; 
            text-align:center; 
        }
        .profile-img { 
            width:150px; 
            height:150px; 
            object-fit:cover; 
            border-radius:50%; 
            border:3px solid #eee; 
            margin-bottom:12px; 
        }
        label { 
            display:block; 
            margin-top:8px; 
            font-size:14px; 
        }
        input[type="text"], input[type="email"], input[type="tel"], 
        textarea { 
            width:100%; 
            padding:8px; 
            margin-top:4px; 
            box-sizing:border-box; 
            border:1px solid #ccc; 
            border-radius:4px; 
        }
        textarea { 
            resize:vertical; 
            min-height:60px; 
        }
        .actions { 
            margin-top:12px; 
            display:flex; 
            gap:8px; 
        }
        button { 
            padding:8px 12px; 
            border:none; 
            border-radius:4px; 
            cursor:pointer; 
        }
        button.primary { 
            background:#0078d4; 
            color:white; 
        }

        button.ghost { 
            background:transparent; 
            border:1px solid #ccc; 
        }
        .meta { 
            text-align:left; 
        }
        .meta div { 
            margin:6px 0; 
        }
        .small { 
            color:#666; font-size:13px; 
        }
    </style>

    <div class="container">
        <h1>Hồ sơ cá nhân</h1>
        <div class="flex">
            <div class="card" id="profileCard" hidden>
                <img id="profileAvatar" class="profile-img" src="" alt="Avatar">
                <h2 id="profileName">Tên</h2>
                <div class="meta">
                    <div><strong>Email:</strong> <span id="profileEmail" class="small"></span></div>
                    <div><strong>Số điện thoại:</strong> <span id="profilePhone" class="small"></span></div>
                    <div><strong>Địa chỉ:</strong> <span id="profileAddress" class="small"></span></div>
                </div>
                <div class="actions" style="justify-content:center; margin-top:14px;">
                    <button id="editBtn" class="ghost">Chỉnh sửa</button>
                    <button id="clearBtn" class="ghost">Xóa hồ sơ</button>
                </div>
            </div>

            <form id="profileForm" class="card" autocomplete="off">
                <label for="name">Họ và tên</label>
                <input id="name" name="name" type="text" required>

                <label for="email">Email</label>
                <input id="email" name="email" type="email" required>

                <label for="phone">Số điện thoại</label>
                <input id="phone" name="phone" type="tel">

                <label for="address">Địa chỉ</label>
                <textarea id="address" name="address"></textarea>

                <label for="avatar">URL ảnh đại diện</label>
                <input id="avatar" name="avatar" type="text" placeholder="https://cdn2.fptshop.com.vn/unsafe/1920x0/filters:format(webp):quality(75)/avatar_vo_tri_a49436c5de.jpg">

                <div class="actions">
                    <button type="submit" class="primary">Lưu hồ sơ</button>
                    <button type="button" id="cancelBtn" class="ghost">Hủy</button>
                </div>
                <p class="small" style="margin-top:10px;">Dữ liệu được lưu cục bộ trên trình duyệt (localStorage).</p>
            </form>
        </div>
    </div>

    <script>
    (() => {
        const STORAGE_KEY = 'userProfile';
        const placeholder = 'https://via.placeholder.com/150?text=Avatar';

        const form = document.getElementById('profileForm');
        const profileCard = document.getElementById('profileCard');
        const editBtn = document.getElementById('editBtn');
        const clearBtn = document.getElementById('clearBtn');
        const cancelBtn = document.getElementById('cancelBtn');

        const els = {
            avatarImg: document.getElementById('profileAvatar'),
            name: document.getElementById('profileName'),
            email: document.getElementById('profileEmail'),
            phone: document.getElementById('profilePhone'),
            address: document.getElementById('profileAddress'),
            inputName: document.getElementById('name'),
            inputEmail: document.getElementById('email'),
            inputPhone: document.getElementById('phone'),
            inputAddress: document.getElementById('address'),
            inputAvatar: document.getElementById('avatar')
        };

        function saveProfile(profile) {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(profile));
        }

        function loadProfile() {
            const raw = localStorage.getItem(STORAGE_KEY);
            return raw ? JSON.parse(raw) : null;
        }

        function renderProfile(profile) {
            if (!profile) {
                profileCard.hidden = true;
                form.hidden = false;
                return;
            }
            els.avatarImg.src = profile.avatar || placeholder;
            els.avatarImg.onerror = () => { els.avatarImg.src = placeholder; };
            els.name.textContent = profile.name || '';
            els.email.textContent = profile.email || '';
            els.phone.textContent = profile.phone || '';
            els.address.textContent = profile.address || '';

            // populate form fields for editing later
            els.inputName.value = profile.name || '';
            els.inputEmail.value = profile.email || '';
            els.inputPhone.value = profile.phone || '';
            els.inputAddress.value = profile.address || '';
            els.inputAvatar.value = profile.avatar || '';

            profileCard.hidden = false;
            form.hidden = true;
        }

        form.addEventListener('submit', e => {
            e.preventDefault();
            const profile = {
                name: els.inputName.value.trim(),
                email: els.inputEmail.value.trim(),
                phone: els.inputPhone.value.trim(),
                address: els.inputAddress.value.trim(),
                avatar: els.inputAvatar.value.trim()
            };
            saveProfile(profile);
            renderProfile(profile);
        });

        editBtn.addEventListener('click', () => {
            profileCard.hidden = true;
            form.hidden = false;
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        cancelBtn.addEventListener('click', () => {
            const existing = loadProfile();
            if (existing) {
                renderProfile(existing);
            } else {
                form.reset();
            }
        });

        clearBtn.addEventListener('click', () => {
            if (!confirm('Xóa toàn bộ thông tin hồ sơ?')) return;
            localStorage.removeItem(STORAGE_KEY);
            form.reset();
            form.hidden = false;
            profileCard.hidden = true;
        });

        // initialize on load
        document.addEventListener('DOMContentLoaded', () => {
            const profile = loadProfile();
            if (profile) renderProfile(profile);
            else {
                form.hidden = false;
                profileCard.hidden = true;
            }
        });
    })();
    </script>
</body>
</html>